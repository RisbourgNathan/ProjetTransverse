{% include 'includes/header.html.twig' %}
<body>
Infos : <br>
Nom : {{ app.user.lastname }} <br>
Prénom : {{ app.user.firstname }} <br>
E-mail : {{ app.user.email }} <br>
Ville : {{ app.user.city }} <br>
Code postal : {{ app.user.zipcode }} <br>
Numéro de téléphone : 0{{ app.user.phone }}<br>

<br/>
<hr>
<br/>
<div>
    <h2>Mes annonces</h2>
    {% if clientPossessions.count != 0 %}
        {% for possession in clientPossessions %}
            <div>
                <p><a href="{{ path('possession_show', {'id': possession.id}) }}">{{ possession.title }}</a></p>
                <p>{{ possession.description }}</p>
                <button><a href="{{ path('proposition_showPropositions', {"idPossession": possession.id})}}">Voir les offres pour cette annonce</a></button>
                {#{% for proposition in possession.proposition %}#}
                    {#<p>{{ proposition.price }}</p>#}
                {#{% endfor %}#}
            </div>
            <br/>
        {% endfor %}
    {% else %}
        <p>Vous n'avez publie aucune annonce</p>
    {% endif %}
</div>

<div>
    <h2>Mes Propositions d'achat</h2>

    {% if propositions.count > 0 %}
        {% for proposition in propositions %}
            {% if proposition.state == "PROPOSITION" %}
                <div class="">
                    <p>En attente d'une reponse du proprietaire...</p>
                </div>

            {% elseif proposition.state == "COUNTERPROPOSITION" %}
                <div class="myPropositionsDiv">
                    <p>{{ proposition.possession.title }} : {{ proposition.getPrice() }} euros.</p>
                    <p>Prix sur l'annonce : {{ proposition.possession.sellingPrice }}</p>
                    <p>Proposition actuelle : {{ proposition.price }} | Proposition originale : {{ proposition.oldPrice }}</p>
                    <button><a href="{{ path('proposition_accept', {'id': proposition.id}) }}">Accepter cette offre</a></button>
                    <button><a href="{{ path('proposition_deny', {'id': proposition.id}) }}">Refuser</a></button>
                </div>
            {% elseif proposition.state == "ACCEPTED" %}
                <div class="myPropositionsDiv">
                    <p>{{ proposition.possession.title }} : {{ proposition.getPrice() }} euros.</p>
                    <p>Prix sur l'annonce : {{ proposition.possession.sellingPrice }}</p>
                    <p>Proposition Acceptee : {{ proposition.price }}</p>
                </div>
            {% elseif proposition.state == "DENIED" %}
                <div class="myPropositionsDiv">
                    <p>{{ proposition.possession.title }} : {{ proposition.getPrice() }} euros.</p>
                    <p>Prix sur l'annonce : {{ proposition.possession.sellingPrice }}</p>
                    <p>Proposition Refusee : {{ proposition.price }}</p>
                </div>
            {% endif %}
        {% endfor %}
    {% else %}
        <p>Vous n'avez fait aucune offre !</p>
    {% endif %}
</div>

<div>
    <h2>Favoris</h2>
    {% if favorites.count != 0 %}
     {% for favorite in favorites %}

           <div>
               <p><a href="{{ path('possession_show', {'id': favorite.possession.id} )}}">{{ favorite.possession.title }}</a></p>
           </div>
    {% endfor %}
    {% endif %}
</div>

<a href="{{ path('modifyProfile') }}">Modifier le profil</a>
</body>
